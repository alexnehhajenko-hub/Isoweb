<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<title>Холст 95% по центру</title>
<style>
  :root{
    --bg:#eef1f5;      /* фон страницы */
    --ui:#ffffff;      /* фон панели */
    --bd:#d9dbe3;      /* бордеры */
    --frame:#cfd3dc;   /* рамка холста */
    --fg:#0f1115;      /* текст */
  }
  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{margin:0;height:100%;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial}
  /* верхняя панель */
  .top{
    position:fixed; inset:0 0 auto 0;
    display:flex; gap:8px; justify-content:center; align-items:center;
    padding:10px; background:var(--ui); border-bottom:1px solid var(--bd); z-index:10;
  }
  .btn{
    background:#f7f8fb; border:1px solid var(--bd); border-radius:12px;
    padding:10px 14px; font-weight:600;
  }

  /* холст — рисуем на <canvas>, но позиционируем оболочку .stage */
  .stage{
    position:fixed; /* расчёт реального положения — через JS, чтобы учесть высоту панели */
    background:#fff; border:1px solid var(--frame);
    box-shadow:0 0 0 1px #fff inset;     /* тонкая «аккуратная» кромка */
    overflow:hidden;                      /* ничего не вылезает */
  }
  canvas{display:block; width:100%; height:100%;}
  /* статус внизу — опционально */
  .status{
    position:fixed; left:12px; bottom:12px; z-index:9;
    background:rgba(0,0,0,.65); color:#fff; padding:8px 12px; border-radius:10px; font-size:13px;
  }
</style>
</head>
<body>
  <div class="top" id="topbar">
    <button class="btn">Линия</button>
    <button class="btn">Назад</button>
    <button class="btn">Фото</button>
    <button class="btn">Центр</button>
    <button class="btn">Сохранить</button>
  </div>

  <div class="stage" id="stage">
    <canvas id="cv"></canvas>
  </div>

  <div class="status" id="status">Холст: 95% экрана, по центру; панель не перекрывает.</div>

<script>
(()=> {
  const stage = document.getElementById('stage');
  const topbar = document.getElementById('topbar');
  const cv = document.getElementById('cv');
  const ctx = cv.getContext('2d', {alpha:false});

  function layout() {
    const vw = window.innerWidth;
    const vh = window.innerHeight;
    const bar = topbar.getBoundingClientRect(); // реальная высота панели

    // размеры холста — 95% от экрана (а не от остатка), как просили
    const w = Math.round(vw * 0.95);
    const h = Math.round(vh * 0.95);

    // центрируем по горизонтали (во всём экране)…
    const x = Math.round((vw - w) / 2);

    // …и по вертикали в «рабочей области» ниже панели
    const freeTop = bar.bottom;
    const freeH = vh - freeTop;
    const y = Math.round(freeTop + (freeH - h)/2);

    // применяем
    stage.style.left = x + 'px';
    stage.style.top  = y + 'px';
    stage.style.width  = w + 'px';
    stage.style.height = h + 'px';

    // настраиваем canvas (учитываю DPR для четкой сетки)
    const dpr = Math.max(1, window.devicePixelRatio || 1);
    cv.width  = Math.round(w * dpr);
    cv.height = Math.round(h * dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);

    drawGrid(w,h);
  }

  function drawGrid(w,h){
    // фон холста
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0,0,w,h);

    // лёгкая «техническая» сетка
    const big = 40; // шаг крупной
    const small = 8; // шаг мелкой

    ctx.lineWidth = 1;
    ctx.strokeStyle = 'rgba(0,0,0,.05)';
    for(let x=0;x<=w;x+=small){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,h); ctx.stroke(); }
    for(let y=0;y<=h;y+=small){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(w,y); ctx.stroke(); }

    ctx.strokeStyle = 'rgba(0,0,0,.12)';
    for(let x=0;x<=w;x+=big){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,h); ctx.stroke(); }
    for(let y=0;y<=h;y+=big){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(w,y); ctx.stroke(); }
  }

  window.addEventListener('resize', layout, {passive:true});
  layout();
})();
</script>
</body>
</html>